<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE en-export SYSTEM "http://xml.evernote.com/pub/evernote-export.dtd">
<en-export export-date="20120908T221412Z" application="Evernote/Windows" version="4.x">
<note><title>Match 17.8.12</title><content><![CDATA[<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE en-note SYSTEM "http://xml.evernote.com/pub/enml2.dtd">

<en-note style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space;"><div><en-todo checked="true"/>Все Loader&apos;ы SFDC и 1С отлажены</div><div><en-todo checked="true"/><font color="#EB0073"><b>!! Объединить</b></font><span>&nbsp;</span><i><b>IsThisStamp</b></i><span>&nbsp;</span>в<span>&nbsp;</span><u><i><b>MoveToMatch</b></i></u><span>&nbsp;</span>c<span>&nbsp;</span><b><i>CheckStamp</i></b><span>&nbsp;</span>в<span>&nbsp;</span><b><i><u>GetRep</u></i></b>. Иначе не загружается PAYMENT в 1С.xlsm</div><div><en-todo checked="false"/>Стоит перенести большую часть<span>&nbsp;</span><b><i><u>MoveToMatch</u></i></b><span>&nbsp;</span>в<i><b><span>&nbsp;</span>match.xlsm</b></i>, оставив в PERSONAL.xlsb только <b><i>OpenFile(F_MATCH)</i></b> - скорее всего, не обращение к MatchLib, а его <u><b>реплику</b></u>, чтобы обойтись без MatchLib в PERSOLAL.xlsb - и <i><b>Application.Run &quot;&apos;&quot; &amp; DirDBs &amp; &quot;match.xlsm&apos;!MoveTo_In_Match&quot;</b></i></div><div><en-todo checked="false"/>Взялись за <b><i><u>HANDLER_Payment</u></i></b>. Проблем масса!</div><div><en-todo checked="false"/> Позанимались маленьким <b><i><u>HANDL_NewContract</u></i></b>. Он загружает в SF только Договоры, которых еще нет в SF, это позволило отработать:</div><ul><li>Создание нового «голубого»&nbsp; листа в <b><i>match.xlsm</i></b> инициализируется при первом обращении к <b><i><u>WrNewSheet</u></i></b> во время прохода по Договорам. Таким образом, инициализация нового листа не требуется, но он может быть в Шаге тодько один. Пока неясно, как с этим ограниченим работать в более сложных HANDLER&apos;ах. Ну хотя бы c организацией отдельных проходов для заполнения каждого голубого листа. Здесь же ведется <u>локальный</u> счетчик строк <u><i><b>iNewSheet</b></i></u>, при каждому обращении вычисляемый как</li></ul><div><i><b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; iNewSheet = EOL ()+1</b></i><br/></div><ul><li>Пытаемся оформить <b><i><u>WrNewSheet</u></i></b> так, чтобы его можно было использовать при проходе по различным Документам- Платежам, Договорам,&nbsp; Складу. Для этого перечень и способ обработки колонок обрабатываемого Документам из файлв в <b><i>DB</i></b> храним вместе с Шапкой для голубого листа на сером листе <b><i><u>Headers</u></i></b> как именованный Range. Каждая колонка этого перечня содержит <u>номер колонки обрабатывемого листа</u>, и, возможно, наименование вида обработки. Если это наименование не указано (=&quot;&quot;), берется только строка из входного файла без обработки, а если указано, то по имени указанного <u><i><b>Адаптера колонки</b></i></u> с помощью <i><b>Select Case</b></i> вызывается соответствующая процедура. Это же способ работы с <u><i><b>Адаптерами</b></i></u> можно будет использовать в файле ASDK.</li><li>Возможно, стоит работу с <u><i><b>Адаптерами</b></i></u> оформить в виде отдельной процедуры (в <u><i><b>ProcessEngine</b></i></u>?), добавив при этом еще один «уровень&nbsp; общности»: значение из поля <b><i>номер колонки</i></b> может быть <u>параметром для</u> <b><i><u>Адаптера</u></i></b> причем возможно указать несколько параметров, разделив их запятыми.</li></ul><div><en-todo checked="false"/>Сейчас написаны лишь черновые версии <b><i><u>WrNewSheet</u></i></b> и именной Range <b><i><u>PAR_NewContractCols</u></i></b> в сером листе Headers файла 1С. Их предстоит дописывать и отлаживать.</div><div><en-todo checked="true"/>Сегодня надо обсудить с Олегом, стоит ли использовать передачу глобальных параметров от Шага к Шагу в Процессе, или пытаться сделать Шаги полностью изолированными, помимо передачи им данных через 5 параметров и <i><b>ActiveSheet</b></i>&nbsp; в <u><i><b>ProcessEngine</b></i></u>.</div></en-note>]]></content><created>20120816T000246Z</created><updated>20120817T183534Z</updated><note-attributes><latitude>60.03160000000000</latitude><longitude>30.34580000000000</longitude><altitude>0.00000000000000</altitude><source>mobile.android</source></note-attributes></note></en-export>
