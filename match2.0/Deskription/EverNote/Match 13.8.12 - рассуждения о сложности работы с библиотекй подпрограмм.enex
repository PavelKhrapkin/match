<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE en-export SYSTEM "http://xml.evernote.com/pub/evernote-export.dtd">
<en-export export-date="20120908T221414Z" application="Evernote/Windows" version="4.x">
<note><title>Match 13.8.12 - рассуждения о сложности работы с библиотекй подпрограмм</title><content><![CDATA[<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE en-note SYSTEM "http://xml.evernote.com/pub/enml2.dtd"><en-note style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space;"><div>Перейдя к <i><b>match 2.0 </b></i>с Документами и программными кодами	, расположенными в различных отдельных файлах, мы были вынуждены подрограммы <u>общего значения</u> поместить в <b><i><u>MatchLib</u></i></b> и повторять эту библиотеку в модулях каждого отдельного файла. Так например, подпрограммы функции <u><i><b>GetRep</b></i></u> и <b><i><u>EOL</u></i></b> есть в файлах <u><i><b>PERSONAL.xlsb</b></i></u> и во всех отдельных файлах <i><b>match.xlsm</b></i>, <b><i>1C.</i></b><i><b>xlsm, SFDC.xlsm </b></i>и других. Это приводит к сложности (а значит и к многочисленным ошибкам!) в процессе корректирования, сохранения и отладки этих подпрограмм.<br/>Казалось бы, назначение <u><i><b>PERSONAL xlsb</b></i></u> именно в том, чтобы содержать библиотеку общих подпрограммы. Даже совсем новый вновь появившийся входной Документ при его открытии на моей машине получает доступ к  <b><i><u>MatchLib</u></i></b> в <b><i><u>PERSONAL.xlsb</u></i></b>. Но Процедуры, получившие управлением по <b><i>Application.Run </i></b><b><i><u>MatchLib</u></i></b> &quot;не видят&quot; и поэтому приходится явно эту библиотеку включать в каждый файл.<br/> </div><div><en-todo></en-todo>Можно ли это изменить? Например, можно ли передать управление Loader&apos;у при помощи конструкции типа <b><i>Application.Call</i></b> ? Стоит поразбираться. </div><div><en-todo></en-todo>Почему Application.Run закрывает доступ к <b><i><u>PERSONAL.xlsb</u></i></b> ? MatchLib используется в MoveToMatch. Вероятно, передача упраления Application.Run связана с «изоляцией контекста». Или я фантазируют? Надо поэкспериментировать! </div><div><en-todo></en-todo>Если невозможно, необходимо придерживаться последовательности: </div><ol><li>Исправления всегда делаются только в <b><i><u>PERSONAL.xlsb</u></i></b>. </li><li>Затем MatchLib копируется во все отдельные файлы в секцию Modules. </li><li>Регулярно (по меньшей мере ежедневно) делается Export и Commit в SVN. </li><li>Необходимо тщательно рассматривать размещение подпрограммы в MatchLib. Даже, казалось бы «общие» подпрограммы помещаются в библиотеку только после отладки и только в том случае, если ими пользуются процедуры из нескольких файлов. </li></ol><div>Нарушение этой процедуры почти всегда приводит к мучительной борьбе с собственной непоследовательностью. <br/> </div><div><en-todo></en-todo>Как результат: после несложных изменений в <b><i><u>GetRep </u></i></b>уже несколько дней не удается отладиться :( </div><div>_____________<br/><u><b>SUMMARY</b></u><br/>В результате обсуждения с Сашей Благодырь:<br/></div><div><en-todo></en-todo>Совсем необязательно хранить коды VBA процедуры в различных файлов Документов. Тип файлов Excel <u><i><b>.xlam</b></i></u> специально предназначен для работы с <u>библиотеками Макросов</u>. Есть достаточно удобные механизмы выборки из <b>AddIns</b>:</div><ol><li>AddIns загружаются из файла .xlam </li><li>Также, как обычные Модули, они видны в VBE в виде отдельного Project</li><li> </li></ol></en-note>]]></content><created>20120813T064930Z</created><updated>20120813T184958Z</updated><note-attributes><latitude>60.03160000000000</latitude><longitude>30.34560000000000</longitude><altitude>0.00000000000000</altitude><source>mobile.android</source></note-attributes></note></en-export>
