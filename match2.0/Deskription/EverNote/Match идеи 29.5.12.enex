<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE en-export SYSTEM "http://xml.evernote.com/pub/evernote-export.dtd">
<en-export export-date="20120908T221535Z" application="Evernote/Windows" version="4.x">
<note><title>Match: идеи 29.5.12</title><content><![CDATA[<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE en-note SYSTEM "http://xml.evernote.com/pub/enml2.dtd"><en-note style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space;"><div><en-todo></en-todo>Обработка ADSKcontract:</div><div><en-todo checked="true"></en-todo>Вначале преобразуем даты</div><div><en-todo checked="true"></en-todo>Затем дедупликация, оставляющая только последнюю строчку с самой поздней датой</div><div><en-todo></en-todo>затем проверка с ADSKfrSF- если в SF Contracts End date &lt; PartnerCenter MSGBOX</div><div><en-todo></en-todo>Будем формировать update ADSK лист?</div><div><en-todo></en-todo>Кажется, после обработки полной обработки ADSK CONTRACT можно стереть?</div><div><en-todo></en-todo>Вообще, может можно стирать все голубые листы?</div><div><en-todo></en-todo>Сводный лист по кнопке</div><div><en-todo></en-todo><u>Не учитывать не состоявшиеся договоры</u></div><div><en-todo></en-todo>Чистить красные SFD и SF</div><div><en-todo></en-todo>Договор 2010-1-155 и 2011-1-135 не загружены DL</div><div><en-todo checked="true"></en-todo>При загрузке из ADSK.xlsx вначале загрузим TOC, затем по Оглавлению загрузим целевой лист или Range данных. Перед загрузкой ТОС стираем - по взможности молча. Имя листа точно соответствует имени отчета.</div><div><en-todo></en-todo>Пока в GetADSKrep можно сделать заглушку - листы уже лежат в Match. После полной обработки отчета Subscriptions (все есть в SF) -стираем (пока похоже только гипотетитески);</div><div><en-todo></en-todo>Subscriptions ADSK:</div><div><en-todo></en-todo>1) проверяем Контракт ADSK в SF call NewContract ADSK(ContractADSK, AccN, AccName) - голубой лист New_ContrADSK для DL. Результат пишем в NewContrADSK.csv. Если не удается подобрать подходящюю Организацию в SF, оставляем запись в LogWr и выходим, оставив ContrADSK пустым.</div><div><en-todo></en-todo>2) проверяем есть ли SN. Если нет - NewSN (ContrADSK) для Upload DL (голубой лист New_SN, после записи в NewSN.CSV его стираем). Для пустого SN не надо проверять наличие Проекта.</div><div><en-todo></en-todo>3) проверяем наличие Проекта в SF. Если нет MsgBox и LogWr предлагаем создать. Сделать это библиотечной подпрограммой NewOppCreate (Acc1C, OppName, CloseDate, Value, GoodType)<br/>––––––––––––</div><div><en-todo checked="true"></en-todo>Проверка Контракта ADSK сначала просто по наличию такого номера	в SF. Если нет -	ячейка красная</div><div><en-todo></en-todo>Затем надо проверить AccauntN.</div><div><en-todo></en-todo>Потом Contract End Date</div><div><en-todo></en-todo>Дальше -	СМ: мейл, телефон, адрес и имя Lcase <br/>––––– 29.5.12 3:30 ––––––––– </div><div><en-todo></en-todo> В GetADSKrep из TOC_ADSK_col получаем mapping используемых полей отчета.  Например, ContrADSK =1, AccName =2, SN=23,..</div><div><en-todo></en-todo>При переносе данных из ADSK.XLSX в Match.xlsm перекладываем колонки в соответствии с Range TOC_ADSK</div><div><en-todo></en-todo>Заголовки преобразованных колонок тоже переназываем. Для этого в базе ADSK есть Range TOC_ADSK_col. В нем колонки «стандартные», а строчки – типы отчетов ADSK.</div><div><en-todo></en-todo>Обработку (раскладку по колонками) отдельных отчетов в соответствии с TOC_ADSK_col можно провести в ADSK.xlsx заранее, результат  поместить в листы следующие за обрабатываемым отчетом. TOC после обработки меняется: ссылка на обработанный листа вставляется перед строкой-  ссылкой на необработанный отчет. Уровень обработки = 1.</div><div><en-todo></en-todo>––––––––– 4.6.12–––––––––––</div><div><en-todo></en-todo>Обработка листа ADSK:</div><div><en-todo></en-todo> Вначале ContrADSKinsert:</div><div><en-todo></en-todo>Выбираем только красные номера контрактов, помещаем в листа C_ADSK_ins.</div><div><en-todo></en-todo>SheetDedup по контрактам</div><div><en-todo></en-todo>Процедуру DL ADSK Contract Insert использовать имеюзуюся или нарисать заново</div><div><en-todo checked="true"></en-todo>Обязательно проверить наличие AccN, при отсутствии ввести вручную</div><div><en-todo checked="true"></en-todo>Потом ввод SN под имеющиеся Контракты Adsk <br/></div></en-note>]]></content><created>20120529T102349Z</created><updated>20120613T073710Z</updated><note-attributes><latitude>60.03190000000000</latitude><longitude>30.34560000000000</longitude><altitude>0.00000000000000</altitude><source>mobile.android</source></note-attributes></note></en-export>
