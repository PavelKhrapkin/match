<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE en-export SYSTEM "http://xml.evernote.com/pub/evernote-export.dtd">
<en-export export-date="20120908T221416Z" application="Evernote/Windows" version="4.x">
<note><title>Match 11.8.2012</title><content><![CDATA[<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE en-note SYSTEM "http://xml.evernote.com/pub/enml2.dtd">

<en-note style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space;"><div><en-todo checked="true"/>Loader&apos; ы почти все отлажены, НО</div><div><en-todo checked="false"/>Оказалось, что <b><i><u>LOAD_</u></i></b><b><i><u>1C</u></i></b><b><i><u>_ACC</u></i></b>&nbsp;- относительно простой Процесс для загрузки из &quot;Справочника организаций 1С&quot; вызывает серьезные трудности:</div><div><en-todo checked="true"/>Написаны два маленьких Шага</div><ol><li><b><i>Acc1C_Bottom</i></b> для переноса верхних трех строк входного докумена в пятку, и</li><li><b><i>AccFill</i></b> для раскраски колонки А со связками с SFacc.</li></ol><div><en-todo checked="true"/>Однако, функционал <b><i>AccFill</i></b> есть в Loader&apos; ах Платежей и Договоров. Поэтому Шаг AccFill написан общим образом: он раскрашивает&nbsp; колонку <u>активного листа</u>.</div><div><en-todo checked="false"/>Предстоит еще <u><b>вычленить</b></u> эту функциональность из&nbsp; Loader&apos; ов Платежей и Договоров в отдельный Шаг AccFill.</div><div><en-todo checked="false"/>Отладка <b><i>AccFill</i></b> обнажила подводные камни:</div><div><ol><li>Обнаружилось, что проверка Штампа не работает потому, что Acc1C_Bottom изменяет положение Штампа на листе, а это не предусмотрено процедурой проверки Штампа в <i><b><u>GetRep(RepName)</u></b></i>. Этот участок GetRep переписан с выделением проверки Штампа в <i><b>Sub CheckStamp(iTOC)</b></i>.</li><li>Значение в колонке- номере строки Штампа разрешено в виде &quot;<b>4, 1, 2</b>&quot;, то есть допускаются различные положения Штампа (ИЛИ), разделенные запятыми. Их проверка проводится после <i><b>Split(R, &quot;,&quot;)</b></i>&nbsp;в цикле по отдельным вариантам <b>R</b>, разделенным делиметрами. Успешное совпадение Штампа по одному из вариантов считается успешным распознаванием Документа <b><i>GetRep</i></b>.</li><li>Оказалось, что проверка другого (других) дополнительных Штампов в последующих за <i><b>GetRep</b></i> строках <i><b>TOCmatch</b></i> по &quot;*&quot; в колонке <b><i>ProcCheck</i></b> не делалась (потерялась?). Ее предполагается реализовать изнутри CheckStamp рекурсивнам вызовом <i><b>CheckStamp(iTOC+1)</b></i>.</li></ol><en-todo checked="false"/>Вслед за отладкой <u><i><b>LOAD_1C_ACC</b></i></u> надо отладить Процесс загрузки SFacc <u><b><i>LOAD_SFacc</i></b></u>, который никак не меняя сам загружаемый лист SFacc запускает все три Процесса <u><i><b>LOAD_1С_Р</b></i></u>, <u><i><b>LOAD_1C_DOG</b></i></u> и <b style="text-decoration: underline; font-style: italic;">LOAD_1C_ACC</b>&nbsp;с Шага <u><i><b>SFlnkFill SFacc</b></i></u>.</div><div><en-todo checked="false"/>Надо убедиться, что общая процедура обновления таблицы Процессов в <b><i><u>ProcessEngine</u></i></b> работает правильно при замене Документа, который используют Шаги других Процессов.<br/></div><div><en-todo checked="false"/>Затем надо браться за Loader Склада и Заказов, а потом за загрузку из <u><b>ADSK.xlsm</b></u>.&nbsp;</div><div><en-todo checked="false"/>Загрузка и препроцессинг новых входных Документов в <u><b>ADSK.xlsm</b></u> сама по себе представляется значительно сложнее, чем загрузка из 1С или SFDC. В ее разработке надо будет максимально использовать функциональность ProcessEngine, чтобы избежать написания сходных кодов в процессах match.xlsm и ADSK.xlsm. Специфика ADSK.xlsm связана с распознаванием колонок входящих Документов по их Заголовкам и пере-мапирование этих Документов с записью результата в таблицу <u><b><i>TOC_ADSK</i></b></u>. В дальнейшем Процессы - Handler&apos;ы будут загружать Документы из ADSK.xlsm в уже подготовленном для работы виде.</div><div><font color="#3665EE" face="Calibri"><b>Я думаю эту работу с ADSK.xlsm стоит отложить по крайней мере на месяц-два до завершения отладки Handler&apos;ов Платежей и Договоров</b></font>. &nbsp;</div><div><en-todo checked="false"/>&nbsp;Соображения по реализации Handler&apos;ов Платежей и Договоров есть в заметке <b><font color="#328712"><u>Match 9.8.12</u></font></b>. <b><font color="#2D4FC9"><font face="Calibri">Но браться за это Процессы я предполагаю недели через две- не раньше, чем будут отлажены все Loader&apos;ы, кроме ADSK</font><font face="Calibri">.</font></font></b></div></en-note>]]></content><created>20120811T072238Z</created><updated>20120811T100456Z</updated><note-attributes><latitude>60.03160000000000</latitude><longitude>30.34580000000000</longitude><altitude>0.00000000000000</altitude><source>mobile.android</source></note-attributes></note></en-export>
